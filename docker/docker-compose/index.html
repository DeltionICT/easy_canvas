<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=IBM+Plex+Sans:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <style>
      @font-face{font-family:BuenosAires;font-style:normal;font-weight:400;src:url('/easy_canvas/_fonts/BuenosAires-Regular.woff2') format("woff2")}@font-face{font-family:BuenosAires;font-style:bold;font-weight:700;src:url('/easy_canvas/_fonts/BuenosAires-Bold.woff2') format("woff2")}@font-face{font-family:BuenosAires;font-style:black;font-weight:900;src:url('/easy_canvas/_fonts/BuenosAires-Black.woff2') format("woff2")}@font-face{font-family:BuenosAires;font-style:light;font-weight:300;src:url('/easy_canvas/_fonts/BuenosAires-Light.woff2') format("woff2")}@font-face{font-family:BuenosAires;font-style:thin;font-weight:100;src:url('/easy_canvas/_fonts/BuenosAires-Thin.woff2') format("woff2")}code[class*=language-],pre[class*=language-]{color:#393a34;background-color:var(--light-grey);font-family:"IBM Plex Mono","Lucida Console","Lucida Sans Typewriter","DejaVu Sans Mono","Bitstream Vera Sans Mono","Liberation Mono","Nimbus Mono L","Courier New",Courier,monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre>code[class*=language-]{font-size:1em}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{background:#c1def1}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#c1def1}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border:1px solid #ddd;background-color:#fff}:not(pre)>code[class*=language-]{padding:.2em;padding-top:1px;padding-bottom:1px;background:#f8f8f8;border:1px solid #ddd}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:green;font-style:italic}.token.namespace{opacity:.7}.token.string{color:#a31515}.token.operator,.token.punctuation{color:#393a34}.token.boolean,.token.constant,.token.inserted,.token.number,.token.symbol,.token.url,.token.variable{color:#36acaa}.language-autohotkey .token.selector,.language-json .token.boolean,.language-json .token.number,.token.atrule,.token.attr-value,.token.keyword,code[class*=language-css]{color:#00f}.token.function{color:#393a34}.language-autohotkey .token.tag,.token.deleted{color:#9a050f}.language-autohotkey .token.keyword,.token.selector{color:#00009f}.token.important{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.language-json .token.property,.token.class-name{color:#2b91af}.token.selector,.token.tag{color:maroon}.token.attr-name,.token.entity,.token.property,.token.regex{color:red}.token.directive.tag .tag{background:#ff0;color:#393a34}.line-numbers.line-numbers .line-numbers-rows{border-right-color:#a5a5a5}.line-numbers .line-numbers-rows>span:before{color:#2b91af}.line-highlight.line-highlight{background:rgba(193,222,241,.2);background:-webkit-linear-gradient(left,rgba(193,222,241,.2) 70%,rgba(221,222,241,0));background:linear-gradient(to right,rgba(193,222,241,.2) 70%,rgba(221,222,241,0))}:root{--dark-grey:#17171a;--light-grey:#f5f4f7;--medium-grey:#afafaf;--orange:#f58220;--blue:#343368;--code-color:#dcf0ff;font-family:BuenosAires,sans-serif;font-weight:400;font-size:16px;line-height:1.9rem;color:var(--blue);scroll-behavior:smooth}body{margin:0;padding:0;background-color:var(--light-grey);font-size:16px;line-height:1.5rem;overflow:scroll}h1{font-size:2rem;font-weight:700;line-height:1rem;text-wrap:nowrap}h2{font-size:1.5rem}h3{font-size:1.25rem}h4{font-size:1.1rem}h5{font-size:1rem}h1[id],h2[id],h3[id]{scroll-margin-top:300px}div#page_wrapper{max-width:1200px;margin:0 auto 0 auto;box-sizing:border-box}main{display:flex;flex-direction:row;margin:0 auto 0 auto;background-color:#fff;justify-content:space-between}div.section{display:none;width:100%;align-items:top}div#title{display:block}div#content{display:flex;flex-direction:column;padding:2rem 2rem 2rem 2rem;min-width:290px;width:100%}header{box-sizing:border-box;width:100%;height:60px;max-height:60px;position:sticky;top:0;z-index:100;color:#fff;padding:0 1rem 0 0;background-color:var(--blue)}header div#title h1{font-weight:700;font-size:1.5rem;width:100%}nav#top{max-width:1200px;display:flex;flex-direction:row;justify-content:space-between;margin:0 auto 0 auto;padding:0}nav#side{display:none}nav#top ul.hide{display:none}nav#side img,nav#top img{display:none;position:relative;top:20px;left:10px}nav#top ul{box-sizing:border-box;list-style-type:none;margin:0;padding:1rem 0 0 0;display:flex;flex-direction:row;justify-content:flex-end;text-align:right}nav#top ul li{box-sizing:border-box;padding:0}nav#side ul li a,nav#top ul li a{box-sizing:border-box;color:#fff;text-decoration:none;font-weight:700;text-wrap:nowrap;padding:0 0 .3rem 0;margin:0 .2rem 0 .8rem}nav#side ul li a.navlinks:visited,nav#top ul li a.navlinks:visited{color:#fff}nav#side ul li a.navlinks.active,nav#side ul li a.navlinks:hover,nav#top ul li a.navlinks.active,nav#top ul li a.navlinks:hover{border-bottom:#f58220 3px solid;padding-bottom:5px}.toc a.active,.toc a:hover{border-bottom:#f58220 1.5px solid;padding-bottom:1px}a.active{border-bottom:#f58220 2px solid}aside#inhoudsopgave{min-width:250px;flex:0 0 250px;background-color:var(--light-grey);padding:1rem;text-wrap:nowrap;box-shadow:rgba(0,0,0,.05) 0 6px 24px 0,rgba(0,0,0,.08) 0 0 0 1px}aside#hiddeninhoudsopgave{display:none}aside#hiddeninhoudsopgave a.panel,aside#inhoudsopgave a.panel{display:inline-block;background-color:#fff;border-radius:.2rem;padding:0 .5rem 0 .5rem}aside#hiddeninhoudsopgave a{position:relative;top:1rem;left:1rem;padding:.2rem .5rem .2rem .5rem;margin-right:20px}div.toc ul{list-style-type:none;padding-left:0;line-height:2rem}div.toc ul li a{text-decoration:none;color:var(--dark-grey)}.green{background-color:#90ee90}:target{display:block}div.section:has(:target){display:block}div.show{display:block}div.hide{display:none}pre[class*=language-]{background-color:var(--light-grey);font-size:.9rem;overflow-x:auto;white-space:pre}pre[class*=language-] code[class*=language-]{display:block;overflow-x:auto;white-space:pre}code{background-color:var(--code-color);padding:.15rem .3rem;border-radius:.3rem;font-size:.9rem;width:100%}nav#top #hoogte-indicator{display:block;position:relative;top:10px;line-height:.2rem;height:10px;background-color:var(--dark-grey);color:#fff;font-size:.5rem;border-radius:.3rem;padding:.3rem .3rem .5rem .3rem}#panel-in,#panel-out{height:0;width:0}#panel-in img,#panel-out img{position:relative;padding:2px;width:10px;height:10px;top:5px;right:20px}#panel-in img{transform:rotate(180deg)}table,td,th{border-collapse:collapse;border:1px solid var(--dark-grey);padding:4px}blockquote{border-left:4px solid var(--blue);margin-left:0;margin-right:0;padding:.5rem 1rem .5rem 1rem;color:var(--dark-grey);background-color:var(--light-grey)}hr{border:0;height:1px;background:var(--medium-grey);margin:2rem 0 2rem 0}img{max-width:100%;height:auto;display:block;margin:0 auto 0 auto}@media (max-width:750px){nav#top{display:none}nav#side{max-width:300px;display:flex;flex-direction:column;justify-content:flex-start;margin:0;padding:0;background-color:var(--blue);position:absolute;top:0}nav#side img{display:block}nav#side ul{display:none;box-sizing:border-box;margin:0;padding:3rem 0 1rem 0;flex-direction:column;text-align:left;justify-content:flex-start}nav#side ul li{padding:.3rem 1rem .3rem 1rem}nav#side ul li a.navlinks{padding:.3rem .3rem .3rem .3rem;margin:0}}section#buttons{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1rem}section#buttons .button-container{position:relative;border-top:1rem solid var(--blue);min-width:200px;height:100px;background-color:var(--light-grey);border-radius:.3rem;box-shadow:rgba(50,50,93,.25) 0 6px 12px -2px,rgba(0,0,0,.3) 0 3px 7px -3px}section#buttons .button-container:hover{background-color:var(--blue)}section#buttons .button-container:hover div{color:#fff}section#buttons .button-container div{color:var(--blue);font-weight:700;position:absolute;bottom:1rem;left:1rem}section#buttons .button-container div::before{content:'';width:2rem;height:1.4rem;background-image:url('/_assets/right-arrow_f58220.svg');background-size:contain;background-repeat:no-repeat;display:inline-block;vertical-align:middle}details{box-sizing:border-box;border-radius:1px;margin-bottom:1rem;display:block;outline:0;padding:0;text-align:left;transition:.4s;background-color:var(--light-grey);width:100%;padding:1rem 2rem 1rem 2rem;border-radius:.3rem;box-shadow:rgba(0,0,0,.05) 0 6px 24px 0,rgba(0,0,0,.08) 0 0 0 1px}summary{font-weight:700;padding-left:38px;cursor:pointer;list-style:none;position:relative}summary a{color:var(--blue);text-decoration:none}summary::before{content:'';background-image:url('/easy_canvas/_assets/right-arrow_f58220.svg');transform:rotate(90deg);background-size:contain;background-repeat:no-repeat;display:inline-block;width:20px;height:20px;vertical-align:middle;position:absolute;top:3px;left:0;font-size:24px;line-height:1;transition:transform .3s}details[open] summary::before{background-image:url('/easy_canvas/_assets/right-arrow_f58220.svg');transform:rotate(270deg)}details p{font-weight:400;padding-left:5px;margin:0}details p.firstchild{padding-top:50px}
    </style>
    <title>Docker</title>
</head>
<body>
    <header>     
      <nav id="top">   
        <a href="#" onclick="toggleNav()"><picture><source type="image/avif" srcset="/easy_canvas/img/pKxxYu2mCg-20.avif 20w"><source type="image/webp" srcset="/easy_canvas/img/pKxxYu2mCg-20.webp 20w"><img src="/easy_canvas/img/pKxxYu2mCg-20.jpeg" alt="menu" width="20" height="15"></picture></a>
        <ul>
      
          <li><a href="/easy_canvas/docker/introductie/#introductie">Introductie</a></li>
      
          <li><a href="/easy_canvas/docker/leerdoelen/#leerdoelen">Leerdoelen</a></li>
      
          <li><a href="/easy_canvas/docker/docker/#docker">Docker</a></li>
      
          <li><a href="/easy_canvas/docker/docker-installeren/#docker-installeren">Docker installeren</a></li>
      
          <li><a href="/easy_canvas/docker/docker-compose/#docker-compose" class="active">Docker compose</a></li>
      
          <li><a href="/easy_canvas/docker/commands/#commands">Commands</a></li>
      
          <li><a href="/easy_canvas/docker/undefined/#undefined"></a></li>
      
        </ul>
      </nav>
      <nav id="side">   
        <a href="#" onclick="toggleNav()"><picture><source type="image/avif" srcset="/easy_canvas/img/pKxxYu2mCg-20.avif 20w"><source type="image/webp" srcset="/easy_canvas/img/pKxxYu2mCg-20.webp 20w"><img src="/easy_canvas/img/pKxxYu2mCg-20.jpeg" alt="menu" width="20" height="15"></picture></a>
        <ul>
      
          <li><a href="/easy_canvas/docker/introductie/#introductie">Introductie</a></li>
      
          <li><a href="/easy_canvas/docker/leerdoelen/#leerdoelen">Leerdoelen</a></li>
      
          <li><a href="/easy_canvas/docker/docker/#docker">Docker</a></li>
      
          <li><a href="/easy_canvas/docker/docker-installeren/#docker-installeren">Docker installeren</a></li>
      
          <li><a href="/easy_canvas/docker/docker-compose/#docker-compose" class="active">Docker compose</a></li>
      
          <li><a href="/easy_canvas/docker/commands/#commands">Commands</a></li>
      
          <li><a href="/easy_canvas/docker/undefined/#undefined"></a></li>
      
        </ul>
      </nav>
  </header>
  <div id="page_wrapper">
  
    <main>

        <div id="content">
        <div class="section" id="title">
            <h1>Docker</h1>
        </div>
        <div class="section">
<h3 id="docker-compose">Docker compose</h3>
<p>Het is handig om voor verschillende processen aparte Docker-images en een <code>docker-compose.yml</code> te gebruiken, omdat je zo je applicatie in onafhankelijke onderdelen opdeelt. Dit principe heet <strong>microservices</strong>.<br>
Elk proces, zoals je PHP webserver en je database, heeft zijn eigen unieke taak en afhankelijkheden. De PHP-webserver heeft Apache of Nginx nodig en de PHP-code, terwijl de database PostgreSQL of MySQL en de dataopslag nodig heeft.</p>
<ul>
<li><strong>Zonder Docker:</strong> Je installeert en configureert alles op dezelfde machine. Dit kan leiden tot conflicten tussen de software en het is moeilijk te beheren.</li>
<li><strong>Met Docker:</strong> Je bouwt één image voor je PHP-webserver en een aparte image voor je database. Elke image is gespecialiseerd in één taak en bevat alleen de bestanden die daarvoor nodig zijn. Je kunt de database bijvoorbeeld updaten zonder je PHP-webserver te verstoren. Dit maakt het systeem <strong>stabieler</strong> en <strong>gemakkelijker te onderhouden</strong>.</li>
</ul>
<p>Door je project op te splitsen in aparte services, is het eenvoudiger voor meerdere mensen om aan verschillende onderdelen te werken. Ook is het makkelijker om de applicatie te testen en te implementeren.</p>
</div>
<div class="section">
<h3 id="de-rol-van-docker-compose.yml">De rol van <code>docker-compose.yml</code></h3>
<p>Het <code>docker-compose.yml</code> bestand brengt al deze losse onderdelen samen. Zie het als een <strong>recept</strong> voor je hele applicatie. Je definieert daarin welke services je nodig hebt (bijvoorbeeld <code>php-app</code> en <code>db</code>), welke images ze moeten gebruiken en hoe ze met elkaar moeten communiceren.</p>
<p><strong>Voorbeeld met PHP en PostgreSQL:</strong></p>
<ol>
<li><strong>php-app service:</strong> Deze service gebruikt een image die je PHP-webserver en code bevat. Het luistert op poort 8080 naar binnenkomende verzoeken.</li>
<li><strong>db service:</strong> Deze service gebruikt de <code>postgres</code> image. Het beheert de database en is alleen toegankelijk voor de <code>php-app</code> service via het interne Docker-netwerk.</li>
</ol>
<p>Het <code>docker-compose.yml</code> bestand zorgt ervoor dat wanneer je het commando <code>docker-compose up</code> uitvoert, beide services tegelijkertijd starten en automatisch met elkaar worden verbonden in hetzelfde netwerk. Zo werken je webapplicatie en database samen alsof ze op dezelfde machine draaien, maar dan zonder de nadelen van een gedeelde omgeving.</p>
<p>Als je deze opzet wil installeren op je eigen laptop, doe dan het volgende:</p>
<ul>
<li>Open een terminal</li>
<li>Maak een nieuwe map aan voor je project <code>mkdir mijnproject</code></li>
<li>Ga in de map staan: <code>cd mijnproject</code></li>
<li>Maak de Dockerfile</li>
<li>Maak de docker-compose.yml</li>
</ul>
<p>De structuur ziet er nu zo uit:</p>
<pre class="language-shell"><code class="language-shell">mijnproject/
├── php-app/
│   └── index.php
├── docker-compose.yml
└── Dockerfile</code></pre>
</div>
<div class="section">
<h3 id="dockerfile">Dockerfile</h3>
<pre class="language-shell"><code class="language-shell"><span class="token comment"># Dockerfile</span>
<span class="token comment"># Gebruik een officiële PHP-image met Apache als basis</span>
FROM php:8.3-apache

<span class="token comment"># Kopieer de bestanden van je applicatie naar de webserver</span>
COPY php-app/ /var/www/html/

<span class="token comment"># Installeer de nodige PHP-extensies, inclusief de PostgreSQL-driver</span>
RUN docker-php-ext-install pdo pdo_pgsql</code></pre>
<pre class="language-yml"><code class="language-yml"><span class="token comment"># docker-compose.yml</span>

<span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3.8'</span>

<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">web</span><span class="token punctuation">:</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span> .
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"8080:80"</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./php<span class="token punctuation">-</span>app<span class="token punctuation">:</span>/var/www/html
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> db
    
  <span class="token key atrule">db</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> postgres<span class="token punctuation">:</span>17<span class="token punctuation">-</span>alpine
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">POSTGRES_USER</span><span class="token punctuation">:</span> <span class="token string">"postgres"</span>
      <span class="token key atrule">POSTGRES_PASSWORD</span><span class="token punctuation">:</span> <span class="token string">"secret!"</span>
      <span class="token key atrule">POSTGRES_DB</span><span class="token punctuation">:</span> <span class="token string">"my_database"</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./db_data<span class="token punctuation">:</span>/var/lib/postgresql/data</code></pre>
<p><strong>Draai de applicatie</strong>
Gebruik <code>docker compose up</code></p>
<ul>
<li>De <code>docker-compose.yml</code> wordt gelezen en uitgevoerd:
<ul>
<li>web: Er wordt een image gemaakt op basis van de <code>Dockerfile</code></li>
<li>Bij het opstarten van de applicatie wordt poort <code>8080</code> bereikbaar gemaakt voor de host. M.a.w. met <code>http://127.0.0.1:8080</code> beriek je de webserver</li>
<li>De map <code>./php-app</code> wordt gekopieerd naar <code>/var/www/html</code> in de container</li>
<li>db: Er wordt een image gedownload met de naam <code>postgres:17-alpine</code></li>
<li>Er worden namen en wachtwoorden ingesteld.</li>
<li>Er wordt een <code>volume</code> aangemaakt in je projectmap met de naam <code>db_data</code></li>
<li>De gegevens uit <code>/var/lib/postgresql/data</code> worden daarin opgeslagen. Hierdoor kun je de data die de database-server gebruikt blijvend bewaren. Als je dit niet zou doen, ben je na iedere herstart al je data weer kwijt uit de database.</li>
</ul>
</li>
</ul>
<p><strong>Stop de applicatie</strong>
<code>docker compose down -v</code></p>
</div>
<div class="section">
<h3 id="opdrachten">Opdrachten</h3>
<ul>
<li>Gelukkig zijn er al heel veel <code>docker-compose.yml</code> bestanden gemaakt. Je hoeft dus niet steeds het wiel opnieuw uit te vinden. Ga naar <a href="https://github.com/docker/awesome-compose">awesome-compose</a> en kies minimaal 2 sets met microservices. Installeer en laat zien dat je alle services kunt draaien op je laptop.</li>
<li>Maak zelf twee microservices voor het verwerken van afbeeldingen
<ul>
<li>De eerste microservice is een website waar je plaatjes kunt uploaden</li>
<li>De tweede microservice is een proces dat de plaatjes aanpast naar een ander formaat bijv. 200px x 200px.</li>
</ul>
</li>
<li>Maak zelf twee microservices voor het converteren van bestanden bijv. csv naar excel
<ul>
<li>De eerste microservice is een website waar je csv-bestanden kunt uploaden</li>
<li>De tweede microservice is een proces dat de bestanden converteer naar excel.</li>
</ul>
</li>
</ul>
</div>

        
        </div>
        <aside id="inhoudsopgave">
            <span><b>Inhoudsopgave</b></span>
            <div class="toc">
        <ul><li><a href="#docker-compose">Docker compose</a></li><li><a href="#de-rol-van-docker-compose.yml">De rol van docker-compose.yml</a></li><li><a href="#dockerfile">Dockerfile</a></li><li><a href="#opdrachten">Opdrachten</a></li></ul>
      </div>        
         </aside> 
         <div id="panel-in" class="panel" onclick="showPanel()"><img style="max-width: initial;" src="/easy_canvas/_assets/2pijltjes_f58220.svg" alt="inklappen"></div>
         <div id="panel-out" class="panel" onclick="hidePanel()"><img style="max-width: initial;" src="/easy_canvas/_assets/2pijltjes_f58220.svg" alt="uitklappen"></div>
    </main>
 
   </div>
    <!--  <script src="/_js/hoogte_indicator.js"></script> -->
    <script>
     function styleActiveLink(){if(!window.location.hash)return void console.log("Geen hashtag aanwezig");const e=window.location.hash;console.log("Hash is veranderd:",e);let o=document.querySelector('a[href="'+e+'"]'),n=document.querySelectorAll(".toc a");for(let e=0;e<n.length;e++)n[e].classList.remove("active");o.classList.add("active"),console.log("Actieve link:",o)}function handleHashChange(e){setTimeout(function(){const e=document.querySelector(window.location.hash);if(e){console.log("Positie van het doel-element:",e.offsetTop);const o=0;console.log("Nieuwe scrollpositie:",o),window.scrollTo({top:o,behavior:"smooth"})}},100)}function hidePanel(){console.log("hidePanel");const e=document.getElementById("panel-in"),o=document.getElementById("panel-out"),n=document.getElementById("inhoudsopgave");o.style.display="none",e.style.display="block",n.style.display="none"}function showPanel(){console.log("showPanel");const e=document.getElementById("inhoudsopgave"),o=document.getElementById("panel-in");document.getElementById("panel-out").style.display="block",o.style.display="none",e.style.display="block"}function toggleNav(){const e=document.querySelector("nav#side ul");"flex"===e.style.display?e.style.display="none":e.style.display="flex"}window.addEventListener("DOMContentLoaded",function(){showPanel(),styleActiveLink(),console.log("De DOM is volledig geladen en geparsed")}),(inhoud=document.querySelector("#inhoudsopgave .toc ul li"))&&inhoud.addEventListener("click",function(e){if(console.log("Inhoudsopgave - Click event detected"),!window.location.hash)return void console.log("Inhoudsopgave - Geen hashtag aanwezig");const o=window.location.hash;console.log("Inhoudsopgave - hashtag:",o)}),window.addEventListener("hashchange",styleActiveLink);
    </script>
    </body> 
</html>